import{f as i,l as y,m,n,q as p,w as o,p as A,r as w,t as l,h as f,k as r}from"./firebase-B_HbBKsG.js";import{d}from"./index-N1P5ay2K.js";const c=t=>t?.toDate()||new Date,R={async getAll(){const t=p(n(d,"classrooms"),l("createdAt","desc"));return(await A(t)).docs.map(e=>({id:e.id,...e.data(),createdAt:c(e.data().createdAt),updatedAt:c(e.data().updatedAt)}))},async getById(t){const s=i(d,"classrooms",t),e=await f(s);return e.exists()?{id:e.id,...e.data(),createdAt:c(e.data().createdAt),updatedAt:c(e.data().updatedAt)}:null},async getByOwner(t){const s=p(n(d,"classrooms"),o("ownerId","==",t),l("createdAt","desc"));return(await A(s)).docs.map(a=>({id:a.id,...a.data(),createdAt:c(a.data().createdAt),updatedAt:c(a.data().updatedAt)}))},async create(t){return(await m(n(d,"classrooms"),{...t,createdAt:r(),updatedAt:r()})).id},async update(t,s){const e=i(d,"classrooms",t);await y(e,{...s,updatedAt:r()})},async delete(t){const s=i(d,"classrooms",t);await w(s)}},I={async getByClassroom(t){const s=p(n(d,"contents"),o("classroomId","==",t),l("order","asc"));return(await A(s)).docs.map(a=>({id:a.id,...a.data(),createdAt:c(a.data().createdAt),updatedAt:c(a.data().updatedAt)}))},async getById(t){const s=i(d,"contents",t),e=await f(s);return e.exists()?{id:e.id,...e.data(),createdAt:c(e.data().createdAt),updatedAt:c(e.data().updatedAt)}:null},async create(t){return(await m(n(d,"contents"),{...t,createdAt:r(),updatedAt:r()})).id},async update(t,s){const e=i(d,"contents",t);await y(e,{...s,updatedAt:r()})},async delete(t){const s=i(d,"contents",t);await w(s)}},B={async getByUser(t){const s=p(n(d,"memberships"),o("userId","==",t));return(await A(s)).docs.map(a=>({id:a.id,...a.data(),joinedAt:c(a.data().joinedAt)}))},async getByClassroom(t){const s=p(n(d,"memberships"),o("classroomId","==",t));return(await A(s)).docs.map(a=>({id:a.id,...a.data(),joinedAt:c(a.data().joinedAt)}))},async create(t){return(await m(n(d,"memberships"),{...t,joinedAt:r()})).id},async delete(t){const s=i(d,"memberships",t);await w(s)}},q={async getByUser(t){const s=p(n(d,"progress"),o("userId","==",t));return(await A(s)).docs.map(a=>({id:a.id,...a.data(),lastAccessedAt:c(a.data().lastAccessedAt)}))},async getByUserAndClassroom(t,s){const e=p(n(d,"progress"),o("userId","==",t),o("classroomId","==",s));return(await A(e)).docs.map(u=>({id:u.id,...u.data(),lastAccessedAt:c(u.data().lastAccessedAt)}))},async getByUserAndContent(t,s){const e=p(n(d,"progress"),o("userId","==",t),o("contentId","==",s)),a=await A(e);if(a.empty)return null;const u=a.docs[0];return{id:u.id,...u.data(),lastAccessedAt:c(u.data().lastAccessedAt)}},async upsert(t){const s=await this.getByUserAndContent(t.userId,t.contentId);if(s){const e=i(d,"progress",s.id);return await y(e,{currentTime:t.currentTime,completed:t.completed,lastAccessedAt:r()}),s.id}else return(await m(n(d,"progress"),{...t,lastAccessedAt:r()})).id}};export{I as a,R as c,B as m,q as p};
