<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0D0221">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèéÔ∏è</text></svg>">
  <title>Car Battle Chase Racing</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <!-- Scanline Overlay -->
  <div class="scanlines"></div>

  <!-- ========== LOADING SCREEN ========== -->
  <div id="loading-screen" class="screen active">
    <div class="loading-container">
      <div class="loading-car-animation">
        <div class="road-scroll"></div>
        <div class="loading-car">
          <div class="car-body"></div>
          <div class="car-wheels">
            <span class="wheel front"></span>
            <span class="wheel back"></span>
          </div>
          <div class="exhaust-flame"></div>
        </div>
      </div>
      <h2 class="loading-title">LOADING</h2>
      <div class="loading-bar-container">
        <div class="loading-bar">
          <div class="loading-progress"></div>
        </div>
        <div class="loading-checkered"></div>
      </div>
      <p class="loading-tip">Tip: Tilt your device to steer!</p>
    </div>
  </div>

  <!-- ========== TITLE SCREEN ========== -->
  <div id="title-screen" class="screen">
    <div class="title-bg">
      <div class="stars-layer"></div>
      <div class="grid-floor"></div>
      <div class="floating-cars-bg">
        <div class="floating-car fc-1"></div>
        <div class="floating-car fc-2"></div>
        <div class="floating-car fc-3"></div>
      </div>
    </div>

    <div class="title-content">
      <!-- Version indicator for debugging -->
      <div id="version-info" style="position: absolute; top: 10px; left: 10px; font-size: 10px; color: #0ff; font-family: monospace; z-index: 9999;">
        v1.3.0 | <span id="build-time"></span>
      </div>
      <script>document.getElementById('build-time').textContent = new Date().toISOString().slice(0,19).replace('T',' ');</script>

      <div class="logo-wrapper">
        <div class="checkered-banner"></div>
        <h1 class="game-logo">
          <span class="logo-car">CAR</span>
          <span class="logo-battle">BATTLE</span>
          <span class="logo-chase">CHASE</span>
        </h1>
        <div class="logo-subtitle">RACING EDITION</div>
        <div class="trophy-decoration">
          <span class="trophy">üèÜ</span>
          <span class="flag">üèÅ</span>
          <span class="trophy">üèÜ</span>
        </div>
      </div>

      <nav class="title-menu">
        <button id="btn-start" class="menu-btn primary">
          <span class="btn-icon">üèéÔ∏è</span>
          <span class="btn-text">START RACE</span>
          <span class="btn-shine"></span>
        </button>
        <button id="btn-settings" class="menu-btn">
          <span class="btn-icon">‚öôÔ∏è</span>
          <span class="btn-text">SETTINGS</span>
        </button>
        <button id="btn-how-to" class="menu-btn">
          <span class="btn-icon">‚ùì</span>
          <span class="btn-text">HOW TO PLAY</span>
        </button>
      </nav>

      <div class="control-hint">
        <div class="gyro-indicator">
          <span class="phone-icon">üì±</span>
          <span class="hint-text">Tilt to Steer</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== SETTINGS SCREEN ========== -->
  <div id="settings-screen" class="screen">
    <div class="screen-header">
      <button id="btn-settings-back" class="back-btn">
        <span class="arrow">‚óÄ</span>
      </button>
      <h2 class="screen-title">SETTINGS</h2>
    </div>

    <div class="settings-panel">
      <!-- Control Mode -->
      <div class="setting-group">
        <h3 class="setting-label">
          <span class="label-icon">üéÆ</span>
          CONTROLS
        </h3>
        <div class="control-toggle">
          <button id="control-gyro" class="toggle-btn active" data-mode="gyro">
            <span class="toggle-icon">üì±</span>
            <span class="toggle-text">TILT</span>
            <span class="toggle-desc">Gyro Steering</span>
          </button>
          <button id="control-touch" class="toggle-btn" data-mode="touch">
            <span class="toggle-icon">üëÜ</span>
            <span class="toggle-text">TOUCH</span>
            <span class="toggle-desc">On-Screen Buttons</span>
          </button>
        </div>
        <p id="gyro-status" class="status-text"></p>
      </div>

      <!-- Sensitivity -->
      <div class="setting-group" id="sensitivity-group">
        <h3 class="setting-label">
          <span class="label-icon">üéØ</span>
          TILT SENSITIVITY
        </h3>
        <div class="slider-container">
          <input type="range" id="sensitivity-slider" min="1" max="5" step="0.5" value="2.5">
          <div class="slider-labels">
            <span>Gentle</span>
            <span id="sensitivity-value">2.5</span>
            <span>Sharp</span>
          </div>
        </div>
      </div>

      <!-- Sound -->
      <div class="setting-group">
        <h3 class="setting-label">
          <span class="label-icon">üîä</span>
          SOUND
        </h3>
        <div class="volume-controls">
          <div class="volume-row">
            <span class="volume-label">BGM</span>
            <input type="range" id="bgm-volume" min="0" max="100" value="50">
            <span class="volume-value">50%</span>
          </div>
          <div class="volume-row">
            <span class="volume-label">SFX</span>
            <input type="range" id="sfx-volume" min="0" max="100" value="70">
            <span class="volume-value">70%</span>
          </div>
        </div>
      </div>

      <!-- Difficulty -->
      <div class="setting-group">
        <h3 class="setting-label">
          <span class="label-icon">üí™</span>
          DIFFICULTY
        </h3>
        <div class="difficulty-buttons">
          <button class="diff-btn" data-diff="easy">50cc</button>
          <button class="diff-btn active" data-diff="normal">100cc</button>
          <button class="diff-btn" data-diff="hard">150cc</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== HOW TO PLAY SCREEN ========== -->
  <div id="howto-screen" class="screen">
    <div class="screen-header">
      <button id="btn-howto-back" class="back-btn">
        <span class="arrow">‚óÄ</span>
      </button>
      <h2 class="screen-title">HOW TO PLAY</h2>
    </div>

    <div class="howto-content">
      <div class="howto-section">
        <h3>üèéÔ∏è RACE</h3>
        <p>Complete 3 laps and finish in 1st place!</p>
      </div>
      <div class="howto-section">
        <h3>üì± STEER</h3>
        <p>Tilt your device left/right to turn</p>
      </div>
      <div class="howto-section">
        <h3>üì¶ ITEMS</h3>
        <p>Drive through item boxes to get power-ups</p>
        <div class="item-list">
          <div class="item-entry"><span>üçÑ</span> Speed Boost</div>
          <div class="item-entry"><span>üçå</span> Banana Trap</div>
          <div class="item-entry"><span>üêö</span> Shell Attack</div>
          <div class="item-entry"><span>‚≠ê</span> Invincibility</div>
        </div>
      </div>
      <div class="howto-section">
        <h3>üí® DRIFT</h3>
        <p>Hold turn while fast to charge boost!</p>
      </div>
    </div>
  </div>

  <!-- ========== GAME SCREEN ========== -->
  <div id="game-screen" class="screen">
    <canvas id="game-canvas"></canvas>

    <!-- HUD -->
    <div id="hud" class="hud">
      <!-- Top HUD -->
      <div class="hud-top">
        <div class="hud-position">
          <span id="current-position" class="position-number">1</span>
          <span class="position-suffix">ST</span>
          <span class="position-total">/5</span>
        </div>
        <div class="hud-lap">
          <span class="lap-label">LAP</span>
          <span id="current-lap" class="lap-number">1</span>
          <span class="lap-separator">/</span>
          <span class="lap-total">3</span>
        </div>
      </div>

      <!-- Item Slot -->
      <div class="hud-item-slot">
        <div id="item-box" class="item-box empty">
          <span id="item-icon" class="item-icon">?</span>
        </div>
        <span class="item-hint">TAP TO USE</span>
      </div>

      <!-- Speed/Boost Meter -->
      <div class="hud-speed">
        <div class="speed-bar">
          <div id="speed-fill" class="speed-fill"></div>
        </div>
        <div id="boost-indicator" class="boost-indicator"></div>
      </div>

      <!-- Pause Button -->
      <button id="btn-pause" class="pause-btn">‚è∏Ô∏è</button>

      <!-- Mini Map (optional) -->
      <div id="mini-map" class="mini-map">
        <canvas id="minimap-canvas"></canvas>
      </div>
    </div>

    <!-- Touch Controls (shown when not using gyro) -->
    <div id="touch-controls" class="touch-controls">
      <div class="steering-buttons">
        <button id="btn-steer-left" class="steer-btn left">‚óÄ</button>
        <button id="btn-steer-right" class="steer-btn right">‚ñ∂</button>
      </div>
      <div class="action-buttons">
        <button id="btn-brake" class="action-btn brake">
          <span class="btn-label">BRAKE</span>
        </button>
        <button id="btn-use-item" class="action-btn use-item">
          <span class="btn-label">ITEM</span>
        </button>
        <button id="btn-accel" class="action-btn accel">
          <span class="btn-label">GAS</span>
        </button>
      </div>
    </div>

    <!-- Gyro Controls (visual feedback) -->
    <div id="gyro-controls" class="gyro-controls">
      <div class="tilt-indicator">
        <div id="tilt-arrow" class="tilt-arrow"></div>
      </div>
      <div class="gyro-action-buttons">
        <button id="btn-brake-gyro" class="action-btn brake">
          <span class="btn-label">BRAKE</span>
        </button>
        <button id="btn-item-gyro" class="action-btn use-item">
          <span class="btn-label">ITEM</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ========== COUNTDOWN OVERLAY ========== -->
  <div id="countdown-overlay" class="overlay">
    <div id="countdown-display" class="countdown-display">
      <span class="countdown-number">3</span>
    </div>
    <div class="countdown-lights">
      <span class="light"></span>
      <span class="light"></span>
      <span class="light"></span>
    </div>
  </div>

  <!-- ========== PAUSE OVERLAY ========== -->
  <div id="pause-overlay" class="overlay">
    <div class="pause-modal">
      <h2 class="pause-title">PAUSED</h2>
      <div class="pause-menu">
        <button id="btn-resume" class="pause-btn-menu">
          <span class="btn-icon">‚ñ∂Ô∏è</span> RESUME
        </button>
        <button id="btn-restart" class="pause-btn-menu">
          <span class="btn-icon">üîÑ</span> RESTART
        </button>
        <button id="btn-quit" class="pause-btn-menu">
          <span class="btn-icon">üè†</span> QUIT
        </button>
      </div>
    </div>
  </div>

  <!-- ========== RESULTS SCREEN ========== -->
  <div id="results-screen" class="screen">
    <div class="results-container">
      <div id="results-header" class="results-header">
        <h2 class="results-title victory">üèÜ 1ST PLACE! üèÜ</h2>
      </div>

      <div class="results-podium">
        <div class="podium-car player">
          <div class="car-avatar">üèéÔ∏è</div>
          <div class="position-badge">1</div>
        </div>
      </div>

      <div class="results-stats">
        <div class="stat-row">
          <span class="stat-label">FINISH TIME</span>
          <span id="result-time" class="stat-value">1:23.45</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">BEST LAP</span>
          <span id="result-best-lap" class="stat-value">0:25.12</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">ITEMS USED</span>
          <span id="result-items" class="stat-value">5</span>
        </div>
      </div>

      <div class="results-rankings">
        <h3>FINAL STANDINGS</h3>
        <div id="rankings-list" class="rankings-list">
          <div class="rank-entry player">
            <span class="rank-pos">1st</span>
            <span class="rank-name">YOU</span>
            <span class="rank-time">1:23.45</span>
          </div>
          <div class="rank-entry">
            <span class="rank-pos">2nd</span>
            <span class="rank-name">CPU 1</span>
            <span class="rank-time">1:24.01</span>
          </div>
          <div class="rank-entry">
            <span class="rank-pos">3rd</span>
            <span class="rank-name">CPU 2</span>
            <span class="rank-time">1:25.33</span>
          </div>
          <div class="rank-entry">
            <span class="rank-pos">4th</span>
            <span class="rank-name">CPU 3</span>
            <span class="rank-time">1:26.78</span>
          </div>
          <div class="rank-entry">
            <span class="rank-pos">5th</span>
            <span class="rank-name">CPU 4</span>
            <span class="rank-time">1:28.90</span>
          </div>
        </div>
      </div>

      <div class="results-buttons">
        <button id="btn-race-again" class="result-btn primary">
          <span>üîÑ</span> RACE AGAIN
        </button>
        <button id="btn-back-title" class="result-btn">
          <span>üè†</span> TITLE
        </button>
      </div>
    </div>
  </div>

  <!-- ========== WRONG WAY WARNING ========== -->
  <div id="wrong-way" class="wrong-way-overlay">
    <div class="wrong-way-text">‚ö†Ô∏è WRONG WAY! ‚ö†Ô∏è</div>
  </div>

  <!-- ========== LAP COMPLETE POPUP ========== -->
  <div id="lap-popup" class="lap-popup">
    <span class="lap-complete-text">LAP <span id="lap-complete-num">1</span></span>
    <span id="lap-time" class="lap-time">0:25.12</span>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
